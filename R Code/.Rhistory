# Load packages
library(ggplot2)
library(tidyverse)
library(stargazer)
library(GGally)
library(lattice)
library(survival)
library(Formula)
library(Hmisc)
library(corrplot)
library(readxl)
library(corrplot)
library(xtable)
library(reshape2)
library(tseries)
data <- read_excel("Master-Thesis/Datasets/data_sa.xlsx")
data <- read_excel("Master-Thesis/Datasets/data_sa.xlsx")
library(readxl)
data_sa <- read_excel("~/Master-Thesis/Datasets/data_sa.xlsx")
View(data_sa)
# upload data
#data <- read_excel("Master-Thesis/Datasets/data_sa.xlsx")
data <- data_sa
library(reshape2)
library(tseries)
# number the columns
data$Obs = 1:nrow(data)
###########################
# Plot Variables          #
###########################
data$date <- as.Date(data$period)
tmp <- data[c("date", "GDP_year_plot", "E_sa", "Var_sa", "Z_sa",
"Var_Z_sa", "Z2_sa", "Var_Z2_sa", "Z3_sa", "Var_Z3_sa")]
meltdf <- melt(tmp,id="date")
meltdf$GDP_year <- data$GDP_year
###########################
# Plot Variables          #
###########################
data$date <- as.Date(data$period)
tmp <- data[c("date", "GDP_year_plot", "E_sa", "Var_sa", "Z_sa",
"Var_Z_sa", "Z2_sa", "Var_Z2_sa", "Z3_sa", "Var_Z3_sa")]
# fill NA's by linear method for YoY GDP, this will help to plot the data
data$Obs <- as.numeric(data$Obs)
data$GDP_year_plot <- with(data, interp1(Obs, GDP_year, Obs, "linear"))
# load libraries
library(readxl)
library(shiny)
library(ggplot2)
library(GGally)
library(stargazer)
library(dplyr)
library(tidyr)
library(reshape2)
library(pracma)
library(scales)
library(ggfortify)
library(forecast)
library(GGally)
library(lattice)
library(survival)
library(Formula)
library(Hmisc)
library(forecast)
# fill NA's by linear method for YoY GDP, this will help to plot the data
data$Obs <- as.numeric(data$Obs)
data$GDP_year_plot <- with(data, interp1(Obs, GDP_year, Obs, "linear"))
# First 5 models
model1 <- lm(GDP_year ~ E_sa, data = data)
###########################
# Plot Variables          #
###########################
data$date <- as.Date(data$period)
tmp <- data[c("date", "GDP_year_plot", "E_sa", "Var_sa", "Z_sa",
"Var_Z_sa", "Z2_sa", "Var_Z2_sa", "Z3_sa", "Var_Z3_sa")]
meltdf <- melt(tmp,id="date")
meltdf$GDP_year <- data$GDP_year
meltdf$date <- as.Date(meltdf$date)
levels(meltdf$variable) <- c("YoY GDP", "BSI", "Var(BSI)", "EIR", "Var(EIR)", "EIR2", "Var(EIR2)", "EIR3", "Var(EIR3)")
ggplot(meltdf,aes(x=date,y=value,group=variable)) +
geom_line(na.rm=FALSE,colour="dodgerblue") +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
facet_grid(rows = vars(variable), scales="free") +
ylab(" ") +
xlab(" ") + theme_bw() +   theme(legend.position = "none",axis.text.x = element_text(angle=45, hjust = 1))
stargazer(cor(na.omit(data[c("Obs", "GDP_year", "E_sa", "Var_sa", "Z_sa","Var_Z_sa")]))
, title="Correlation Matrix")
tmp <- data[c("GDP_year", "E_sa", "Var_sa", "Z_sa","Var_Z_sa", "Z2_sa","Var_Z2_sa", "Z3_sa","Var_Z3_sa")]
# descriptive table
stargazer(as.data.frame(tmp))
#### GDP corr with the different indicators
stargazer(cor(na.omit(data2[c("GDP_year", "E_I", "E_1", "E_2","E_3","E_4")]))
, title="Correlation Matrix")
ggpairs(data2[c("GDP_year", "E_1", "E_2","E_3","E_4")],
upper = list(continuous = wrap("cor", size = 6))
, columnLabels = c("YoY GDP", "BSI Q1", "BSI Q2", "BSI Q3", "BSI Q4"))  + theme_bw()
corrplot.mixed(cor(na.omit(data2[c("GDP", "GDP_year", "E_1", "E_2","E_3","E_4")]))
, tl.col = "black"
,lower = "circle", upper = "number")
#### GDP corr with the different indicators
stargazer(cor(na.omit(data[c("GDP_year", "E", "Var", "Z","Var_Z", "Z2","Var_Z2", "Z3","Var_Z3")])), title="Correlation Matrix")
ggpairs(data[c("GDP_year", "E_sa", "Var_sa", "Z_sa","Var_Z_sa", "Z2_sa","Var_Z2_sa", "Z3_sa","Var_Z3_sa")], upper = list(continuous = wrap("cor", size = 6)),
columnLabels = c("YoY GDP", "BSI", "Var(BSI)", "EIR1", "Var(EIR1)", "EIR2", "Var(EIR2)", "EIR3", "Var(EIR3)"))  + theme_bw()
# Correlation Matrix check Question 3 and 4 if true what they say
# Question 3
stargazer(cor(na.omit(data2[c("GDP", "GDP_year", "E_3", "E_3_lag1","E_3_lag2","E_3_lag3","E_3_lag4")])), title="Correlation Matrix")
# Question 4
stargazer(cor(na.omit(data2[c("GDP", "GDP_year", "E_4", "E_4_lag1","E_4_lag2","E_4_lag3","E_4_lag4")])), title="Correlation Matrix")
meltdf <- melt(tmp,id="date")
meltdf$GDP_year <- data$GDP_year
meltdf$date <- as.Date(meltdf$date)
levels(meltdf$variable) <- c("YoY GDP", "BSI", "Var(BSI)", "EIR", "Var(EIR)", "EIR2", "Var(EIR2)", "EIR3", "Var(EIR3)")
ggplot(meltdf,aes(x=date,y=value,group=variable)) +
geom_line(na.rm=FALSE,colour="dodgerblue") +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
facet_grid(rows = vars(variable), scales="free") +
ylab(" ") +
xlab(" ") + theme_bw() +   theme(legend.position = "none",axis.text.x = element_text(angle=45, hjust = 1))
