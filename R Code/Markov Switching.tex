\begin{lstlisting}
    

library(depmixS4)
library(tidyverse)
library(readxl)
library(ggplot2)
library(gridExtra)
library(reshape2)
library(tseries)
library(MSwM)
# TEST

data<-read_excel("//vsrres010.nbb.local/ressources_p/TRICONAT/EMOS/Stage2018/Datasets/RS_975.xlsx",
                 sheet="MI027")

mod <- depmix(list(Solde_UW ~ 1,Increase ~ 1), data = data, nstates = 2,
          family = list(gaussian(), multinomial("identity")),
          transition = ~ scale(var_UW), instart = runif(2))
fm <- fit(mod, verbose = FALSE, emc=em.control(rand=FALSE))
hmm1 <- fm
summary(fm)







attach(data)

library(MSwM)
help(MSwM)

#Model with only intercept
mod<-lm(Solde_UW ~ 1)

#Fit regime-switching model
mod.mswm=msmFit(mod, k=2, sw=c(T,T), p=0)
plot(mod.mswm)











#####################################################







olsBI <- lm(Solde_UW ~ 1)

summary(olsBI)

# MS for Value Stocks (k is number of regimes, 6 is for means of 5 variables
# + 1 for volatility)
msBI = msmFit(olsBI, k = 2, sw = rep(TRUE, 3), p=1)

# p= 1 is the number of AR coefficients that the MS model has to have.

msBIAR = msmFit(olsBI, k = 2, sw = rep(TRUE, 6), p=1)

summary(msBI)


par(mar=c(3,3,3,3))
plotProb(msBI, which=1)

plotProb(msBI, which=2)


par(mar=c(3,3,3,3))
plotDiag(msBI, regime=1, which=1)

plotDiag(msBI, regime=1, which=2)

plotDiag(msBI, regime=1, which=3)






#####################################################







olsBI <- lm(Solde_UW_diff ~ 1)

summary(olsBI)

# MS for Value Stocks (k is number of regimes, 6 is for means of 5 variables
# + 1 for volatility)
msBI = msmFit(olsBI, k = 2, sw = rep(TRUE, 2))

summary(msBI)

dates <- seq(as.Date("01/01/1988", format = "%d/%m/%Y"),
             by = "months", length = length(372))

plot(dates, msBI)

plot(MSM.fitted)

msBI.msm


par(mar=c(3,3,3,3))
plotProb(msBI, which=1)

plotProb(msBI, which=2)


par(mar=c(3,3,3,3))
plotDiag(msBI, regime=1, which=1)

plotDiag(msBI, regime=1, which=2)

plotDiag(msBI, regime=1, which=3)

\end{lstlisting}